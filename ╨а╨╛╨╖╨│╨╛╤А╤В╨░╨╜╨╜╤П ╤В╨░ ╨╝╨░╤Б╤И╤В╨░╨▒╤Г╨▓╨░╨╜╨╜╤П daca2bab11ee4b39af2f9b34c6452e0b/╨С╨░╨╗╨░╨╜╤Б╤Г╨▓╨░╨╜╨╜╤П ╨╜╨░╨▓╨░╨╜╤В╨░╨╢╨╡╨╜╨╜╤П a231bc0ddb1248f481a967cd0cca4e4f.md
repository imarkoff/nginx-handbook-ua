# –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

<aside>
üí° **–ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** load balancing - —Ü–µ –ø—Ä–æ—Ü–µ—Å —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Ç—Ä–∞—Ñ—ñ–∫—É –º—ñ–∂ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –∑ –º–µ—Ç–æ—é –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –≤–∏—Å–æ–∫–æ—ó –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ —Ç–∞ —à–≤–∏–¥–∫–æ–¥—ñ—ó –¥–æ–¥–∞—Ç–∫—É. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è NGINX —è–∫ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ —Ä–æ–±–æ—Ç—É –¥–æ–¥–∞—Ç–∫—É –ø—Ä–∏ –≤–µ–ª–∏–∫–æ–º—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ, —Ä–æ–∑–ø–æ–¥—ñ–ª–∏–≤—à–∏ –π–æ–≥–æ –º—ñ–∂ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞–º–∏.

</aside>

–î–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è NGINX —è–∫ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ:

1. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ —ñ–º–µ–Ω–∞–º–∏ —Ö–æ—Å—Ç—ñ–≤ —Ç–∞ IP-–∞–¥—Ä–µ—Å–∞–º–∏ —Å–µ—Ä–≤–µ—Ä—ñ–≤-—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ —É —Ñ–∞–π–ª—ñ `/etc/hosts` –∞–±–æ –≤ DNS-—Å–µ—Ä–≤–µ—Ä—ñ.
    
    ```bash
    127.0.0.1       localhost
    192.168.1.1     server1
    192.168.1.2     server2
    ```
    
    –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DNS-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –º—ñ–∂ —ñ–º–µ–Ω–∞–º–∏ —Ö–æ—Å—Ç—ñ–≤ —Ç–∞ IP-–∞–¥—Ä–µ—Å–∞–º–∏. –¶–µ –¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ IP-–∞–¥—Ä–µ—Å–∏ —Å–µ—Ä–≤–µ—Ä—ñ–≤-—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –∑–∞ —ó—Ö–Ω—ñ–º–∏ —ñ–º–µ–Ω–∞–º–∏ —Ö–æ—Å—Ç—ñ–≤. –©–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –¥–æ–¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∑–∞–ø–∏—Å–∏ –¥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó DNS-—Å–µ—Ä–≤–µ—Ä–∞.
    
    ```bash
    server1     IN A    192.168.1.1
    server2     IN A    192.168.1.2
    ```
    
2. –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è NGINX, —É —è–∫–æ–º—É –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏-—Ä–æ–±—ñ—Ç–Ω–∏–∫–∏ –∑–∞ –æ–¥–Ω–∏–º –∑ –º–µ—Ç–æ–¥–æ–º –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.
    - –ú–µ—Ç–æ–¥–∏ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        - **Round Robin** - –∑–∞–ø–∏—Ç–∏ —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—é—Ç—å—Å—è –º—ñ–∂ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–∞–≥–∏ —Å–µ—Ä–≤–µ—Ä—ñ–≤. –¶–µ–π –º–µ—Ç–æ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:
            
            ```bash
            upstream backend {
                server backend1.example.com;
                server backend2.example.com;
                server backend3.example.com;
              }
            ```
            
        - **Least Connections** - –∑–∞–ø–∏—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑ –Ω–∞–π–º–µ–Ω—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∞–∫—Ç–∏–≤–Ω–∏—Ö –∑'—î–¥–Ω–∞–Ω—å, –∑–Ω–æ–≤—É –∂ —Ç–∞–∫–∏ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–∞–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
            
            ```bash
            upstream backend {
                least_conn;
                server backend1.example.com;
                server backend2.example.com;
            }
            ```
            
        - **IP Hash** - —Å–µ—Ä–≤–µ—Ä, –Ω–∞ —è–∫–∏–π –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Ç, –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑ IP-–∞–¥—Ä–µ—Å–∏ –∫–ª—ñ—î–Ω—Ç–∞. –ü—Ä–∏ —Ü—å–æ–º—É –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ö–µ—à-–∑–Ω–∞—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –∞–±–æ –ø–µ—Ä—à—ñ —Ç—Ä–∏ –æ–∫—Ç–µ—Ç–∏ IPv4-–∞–¥—Ä–µ—Å–∏, –∞–±–æ –≤—Å—è IPv6-–∞–¥—Ä–µ—Å–∞. –ú–µ—Ç–æ–¥ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –∑–∞–ø–∏—Ç–∏ –∑ –æ–¥–Ω—ñ—î—ó —ñ —Ç—ñ—î—ó –∂ –∞–¥—Ä–µ—Å–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å –Ω–∞ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —Å–µ—Ä–≤–µ—Ä, —è–∫—â–æ —Ç—ñ–ª—å–∫–∏ –≤—ñ–Ω –Ω–µ —î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º.
            
            ```bash
            upstream backend {
                ip_hash;
                server backend1.example.com;
                server backend2.example.com;
            }
            ```
            
            –Ø–∫—â–æ –æ–¥–∏–Ω —ñ–∑ —Å–µ—Ä–≤–µ—Ä—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ç–∏–º—á–∞—Å–æ–≤–æ –≤–∏–ª—É—á–∏—Ç–∏ –∑ —Ä–æ—Ç–∞—Ü—ñ—ó –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –π–æ–≥–æ –º–æ–∂–Ω–∞ –ø–æ–∑–Ω–∞—á–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `down`, —â–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–æ—Ç–æ—á–Ω–µ —Ö–µ—à—É–≤–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö IP-–∞–¥—Ä–µ—Å. –ó–∞–ø–∏—Ç–∏, —è–∫—ñ –ø–æ–≤–∏–Ω–Ω—ñ –±—É–ª–∏ –æ–±—Ä–æ–±–ª—è—Ç–∏—Å—è —Ü–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –≤ –≥—Ä—É–ø—ñ:
            
            ```bash
            upstream backend {
                server backend1.example.com;
                server backend2.example.com;
                server backend3.example.com down;
            }
            ```
            
        - **Generic Hash** - —Å–µ—Ä–≤–µ—Ä, –Ω–∞ —è–∫–∏–π –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Ç, –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –∫–ª—é—á–µ–º, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–∏–º —Ä—è–¥–∫–æ–º, –∑–º—ñ–Ω–Ω–æ—é –∞–±–æ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—î—é. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–ª—é—á –º–æ–∂–µ –±—É—Ç–∏ –ø–∞—Ä–Ω–æ—é IP-–∞–¥—Ä–µ—Å–æ—é —ñ –ø–æ—Ä—Ç–æ–º –¥–∂–µ—Ä–µ–ª–∞ –∞–±–æ URI, —è–∫ —É —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ:
            
            ```bash
            upstream backend {
                hash $request_uri consistent;
                server backend1.example.com;
                server backend2.example.com;
            }
            ```
            
3. –ó–∞–¥–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.
    
    ```bash
    http {
      upstream backend {
        ...
      }
    
      server {
        listen 80;
        server_name myapp.com;
    
        location / {
          proxy_pass <http://backend>;
          proxy_set_header Host $host;
          proxy_set_header X-Real-IP $remote_addr;
        }
      }
    }
    
    ```